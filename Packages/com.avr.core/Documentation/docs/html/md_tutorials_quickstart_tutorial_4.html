<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
		<meta http-equiv="X-UA-Compatible" content="IE=9"/>
		<meta name="generator" content="Doxygen 1.8.7"/>
		<meta name="viewport" content="width=device-width, initial-scale=1"/>
		<title>ARC-VR: quickstart_tutorial_4</title>
		<link href="tabs.css" rel="stylesheet" type="text/css"/>
		<script type="text/javascript" src="jquery.js"></script>
		<script type="text/javascript" src="dynsections.js"></script>
		<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
		<link href="doxygen.css" rel="stylesheet" type="text/css" />
		<link href="custom_theme.css" rel="stylesheet" type="text/css"/>
	</head>
	<body>
	<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
		<div id="titlearea">
			<table cellspacing="0" cellpadding="0">
				<tbody>
					<tr style="height: 56px;">
						<td id="projectlogo">
							<a href="index.html">
								<img alt="Logo" src="avr_logo_small.png"/>
							</a>
						</td>
						<td id="projectalign" style="padding-left: 0.5em;">
							<div id="projectbrief">VR Devemopment Framework</div>
							<div id="projectnumber">v 1.0.0</div>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		<!-- end header part --><!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Properties</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Events</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">quickstart_tutorial_4 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="image">
<img src="../../res/images/avr_logo_bw_wide.png"  alt="Logo"/>
</div>
<h1>Step 9: Adding UI Interaction</h1>
<p>We want the player to guess which color they'll draw <em>before</em> reaching into the urn. We'll do this by presenting the player with an in-game UI window, for which we'll need the <a class="el" href="md_tutorials_arc-vr-ui.html#arc-vr-ui">arc-vr-ui</a> package.</p>
<p>The installation procedure shoule be familiar by now: download the .tgz from github, import it via the package manager.</p>
<p>The subsequent steps should be familiar as well: select the controller you want to act as a UI pointer, click 'Add Module' and select 'UIInteractionProvider'.</p>
<p>If you now select the UIInteractionProvider, you might notice the warning it displays. As with any Unity-related UI system, an 'EventSystem' is required. If you click the 'Fix now' button, a new EventSystem object will be created (together with an attatched VRInput component).</p>
<p>The selected controller is now fully functional as a UI pointer, which will work with any world-space unity canvas.</p>
<h2>Adding UI elements</h2>
<p>The arc-vr-ui package comes with several pre-fabricated UI elements, which we'll make use of in the next steps. There are seveal options to find what we're looking for:</p>
<ul>
<li>Use the Project explorer to navigate to <code>Packages &gt; arc-vr-ui &gt; Runtime &gt; Prefabs</code> and find 'GenericWindow_Borderless'.</li>
<li>Type 'window' into the project explorer search-bar, then filter only by prefabs and set the search to 'In Packages', rather than 'In Assets'. Find the GenericWindow_Borderless prefab.</li>
<li>Run the command <code>prefabs ui window</code> in the developers console. This will set your project explorer search to look for the word 'window' inside the arc-vr-ui package. Find the GenericWindow_Borderless prefab.</li>
</ul>
<p>Once you've found it, drag the 'GenericWindow_Borderless' into scene and place it in front of the table.</p>
<p>Next up we'll need some buttons. Use any of the methods above to search for button. You should find a simple 'Button_large' prefab. Drag three of them onto the GenericWindow, place them one above the other and change their text to "Guess Blue", "Guess Red" and "Start" respectively.</p>
<p>We now have all the elements of our scene ready. The buttons won't actually do anything as of right now, but they'll be clickable with a controller.</p>
<h1>Step 10: Setting up a TrialExperiment</h1>
<p>For this next step we'll be using the <a class="el" href="class_a_v_r_1_1_core_1_1_a_v_r___trial_experiment.html">TrialExperiment</a> class to create a trial-based structure to our experiment. A 'trial' will follow the following procedure:</p>
<ul>
<li>Hide the urn + balls, display the UI buttons</li>
<li>If the player clicks one of the guess buttons, hide the UI and show the urn</li>
<li>After a couple of seconds, return to step 1.</li>
</ul>
<p>The implementation is simple. Create a new script (call it something like <code>UrnExperiment</code>) and make it inherit from <a class="el" href="class_a_v_r_1_1_core_1_1_a_v_r___trial_experiment.html" title="Base class to inherit from in order to create trial-based experiments. (One experiment consists of on...">AVR.Core.AVR_TrialExperiment</a>. The TrialExperiment class is a simple one that models trials as Coroutines. We'll simply override the <code>trial()</code> function with the above listed procedure. Add this code inside your class: </p><pre class="fragment">public GameObject urn;
public GameObject guess_ui;

public override IEnumerator trial() {
    // Disable urn, enable UI
    urn.SetActive(false);
    guess_ui.SetActive(true);

    // Wait for next step
    yield return new WaitUntil(can_proceed);

    // Enable urn, disable UI
    urn.SetActive(true);
    guess_ui.SetActive(false);

    // Wait a couple of seconds
    yield return new WaitForSeconds(5);
}
</pre><p>Now attach this script to some fitting gameobject.</p>
<h1>Step 11: Finishing Up</h1>
<p>As a last step, we'll just have to connect all the dots.</p>
<p>If you haven't already, parent the urn and all the balls under a single gameobject, so we can easily toggle them on and off.</p>
<p>Then select your 'UrnExperiment' script we created in the previous step and assign the 'urn' property to be the parent object of the urn and balls. Assign the 'guess_ui' property to the GenericWindow that includes the three buttons.</p>
<p>Select each of the buttons, and add an 'OnClick' event. For the 'Guess Blue' / 'Guess Red' buttons set the OnClick event to be <code>UrnExperiment.proceed()</code>. For the 'Start' button, set it to <code>UrnExperiment.commence</code>, with the amount of trials as the argument (eg. 10).</p>
<p>If you now click play, the project should be complete. Once you click the 'Start' button, the urn will be hidden. It will then only show once you've guessed a color. You will then have 5 seconds to draw a sphere before the process begins again.</p>
<h1>Step 12: Data Collection</h1>
<p>If we wish to record and collect data on the experiment, we can use the provided <a class="el" href="class_a_v_r_1_1_core_1_1_a_v_r___logger.html">AVR_Logger</a> class.</p>
<p>Simply select any gameobject (for instance the same one that has the 'UrnExperiment' script) and add an AVR_Logger component to it.</p>
<p>We're going to keep things simple, and create a basic csv-table with two columns: time and the corresponding object the player is grabbing.</p>
<p>Add a new entry to the 'Columns' property, set the label to 'time' and select the type as 'TIME'. Add a second entry, set the label to something like 'object' and leave the type as 'CUSTOM'.</p>
<p>The AVR_Logger uses C# reflection to extract properties from certain objects, including private or protected ones. Any value exposed in a property is thus simple to log with this. In our case, we want to know what the player is holding on to, so it seems logical to look for an appropriate field in our BasicGrabProvider script. If you look at the docs for <a class="el" href="class_a_v_r_1_1_phys_1_1_a_v_r___basic_grab_provider.html">BasicGrabProvider</a> you'll see it has a protected field called 'grabbedObject', which corresponds to the AVR_Grabbable the player is holding.</p>
<p>To log this field, simply drag and drop the BasicGrabProvider into the 'Target' field of the newly created column and set 'Field' to be <code>grabbedObject</code>. Leave read type as 'AUTO'.</p>
<p>If you now launch the scene again, there'll be a <code>logs/sample.log</code> file which includes a timestamp as well as the name of the object the player is holding at that time. </p>
</div></div><!-- contents -->
<!-- start footer part -->
		<script src="custom.js"></script>
	</body>
</html>
